<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login + Profile + JSON Fetch</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:Arial, sans-serif; }
    body {
      background:#f0f0f0;
      display:flex;
      flex-direction:column;
      min-height:100vh;
    }
    header, footer {
      background:#1976d2;
      color:#fff;
      padding:12px 20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    header h1 { font-size:20px; }
    .content {
      flex:1;
      background:#fff;
      padding:20px;
    }
    footer { text-align:center; }
    /* Login box */
    .loginBox {
      background:#fff;
      padding:20px;
      border-radius:8px;
      box-shadow:0 4px 10px rgba(0,0,0,0.2);
      width:320px;
      margin:30px auto;
      display:none;
    }
    .loginBox input {
      width:100%;
      padding:10px;
      margin:8px 0;
      border:1px solid #ccc;
      border-radius:6px;
    }
    .loginBox button {
      width:100%;
      padding:10px;
      border:none;
      background:#1976d2;
      color:#fff;
      border-radius:6px;
      cursor:pointer;
      font-size:16px;
      transition:0.3s;
    }
    .loginBox button:hover { background:#1255a2; }
    /* Clean Login Btn */
    #loginBtn {
      background:#fff;
      color:#1976d2;
      border:none;
      padding:8px 18px;
      border-radius:20px;
      cursor:pointer;
      font-size:15px;
      transition:0.3s;
    }
    #loginBtn:hover { background:#e3f2fd; }
    /* Profile small icon */
    .profile-pic {
      width:38px;
      height:38px;
      border-radius:50%;
      cursor:pointer;
      object-fit:cover;
      display:none;
    }
    /* Profile dropdown */
    .profile-card {
      position:absolute;
      top:60px;
      right:20px;
      background:#fff;
      color:#000;
      border-radius:8px;
      box-shadow:0 4px 10px rgba(0,0,0,0.3);
      padding:15px;
      width:220px;
      display:none;
      z-index:100;
    }
    .profile-card img {
      width:70px;
      height:70px;
      border-radius:50%;
      display:block;
      margin:0 auto 10px;
    }
    .profile-card h3 { text-align:center; margin:5px 0; }
    .profile-card p { font-size:14px; text-align:center; color:#555; }
    .profile-card button {
      background:#1976d2;
      color:#fff;
      border:none;
      padding:8px 14px;
      border-radius:6px;
      cursor:pointer;
      margin-top:10px;
      width:100%;
    }
    .show { display:block !important; }
    /* Data cards */
    .card {
      background:#fafafa;
      border:1px solid #ddd;
      border-radius:8px;
      padding:15px;
      margin:10px 0;
    }
    .card a {
      color:#1976d2;
      font-weight:bold;
      text-decoration:none;
    }
    .card a:hover { text-decoration:underline; }
    /* Responsive */
    @media(max-width:600px) {
      header, footer { flex-direction:column; text-align:center; }
      .profile-card { right:50%; transform:translateX(50%); }
    }
  </style>
</head>
<body>

  <header>
    <h1>VidyaSagar</h1>
    <div>
      <button id="loginBtn">Login</button>
      <img src="https://i.pravatar.cc/150?img=12" id="profilePic" class="profile-pic">
    </div>
  </header>

  <!-- Profile Dropdown -->
  <div id="profileCard" class="profile-card">
    <img src="https://i.pravatar.cc/150?img=12" alt="Profile">
    <h3 id="profileName">Guest</h3>
    <p>Welcome to VidyaSagar!</p>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Login Box -->
  <div class="loginBox" id="loginBox">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Enter Name">
    <input type="password" id="password" placeholder="Password (vidyasagar)">
    <button onclick="login()">Login</button>
  </div>

  <!-- Content -->
  <div class="content">
    <h2>Welcome!</h2>
    <div id="dataContainer">
      <p>Login to see JSON data.</p>
    </div>
  </div>

  <footer>
    <p>© 2025 VidyaSagar. All Rights Reserved.</p>
  </footer>

  <script>
    const USERPASS = "vidyasagar";
    const EXPIRY_DAYS = 3; // 3 days auto logout

    const loginBtn = document.getElementById("loginBtn");
    const loginBox = document.getElementById("loginBox");
    const profilePic = document.getElementById("profilePic");
    const profileCard = document.getElementById("profileCard");
    const profileName = document.getElementById("profileName");
    const dataContainer = document.getElementById("dataContainer");

    // Show login box
    loginBtn.addEventListener("click", () => {
      loginBox.style.display = loginBox.style.display === "block" ? "none" : "block";
    });

    function login() {
      let username = document.getElementById("username").value;
      let password = document.getElementById("password").value;

      if(password === USERPASS && username.trim() !== "") {
        const loginData = {
          username: username,
          loginTime: new Date().getTime()
        };
        localStorage.setItem("userSession", JSON.stringify(loginData));

        showProfile(username);
        loginBox.style.display = "none";
        fetchData(); // login के बाद JSON लोड होगा
        alert("Login successful!");
      } else {
        alert("Invalid credentials. Password is 'vidyasagar'");
      }
    }

    function showProfile(name) {
      loginBtn.style.display = "none";
      profilePic.style.display = "inline-block";
      profileName.textContent = name;
    }

    function logout() {
      localStorage.removeItem("userSession");
      profilePic.style.display = "none";
      loginBtn.style.display = "inline-block";
      profileCard.classList.remove("show");
      dataContainer.innerHTML = "<p>Login to see JSON data.</p>";
    }

    function fetchData() {
      fetch("alldata.json")
        .then(res => res.json())
        .then(data => {
          dataContainer.innerHTML = "";
          data.forEach(item => {
            let card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `<a href="${item.link}" target="_blank">${item.link}</a><p>${item.explanation}</p>`;
            dataContainer.appendChild(card);
          });
        })
        .catch(err => {
          dataContainer.innerHTML = "<p style='color:red;'>Error loading JSON data.</p>";
        });
    }

    // Restore session on load
    window.onload = function() {
      const session = JSON.parse(localStorage.getItem("userSession"));
      if(session) {
        const now = new Date().getTime();
        const expiry = EXPIRY_DAYS * 24 * 60 * 60 * 1000;
        if(now - session.loginTime < expiry) {
          showProfile(session.username);
          fetchData(); // already logged in → show data
        } else {
          logout(); // session expired
        }
      }
    };

    // Profile dropdown toggle
    profilePic.addEventListener("click", () => {
      profileCard.classList.toggle("show");
    });

    // Close dropdown if clicked outside
    document.addEventListener("click", (e) => {
      if (!profileCard.contains(e.target) && e.target !== profilePic) {
        profileCard.classList.remove("show");
      }
    });
  </script>
</body>
</html>